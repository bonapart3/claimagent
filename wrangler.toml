# Cloudflare Workers Configuration for ClaimAgent™
# https://developers.cloudflare.com/workers/wrangler/configuration/
# wrangler.toml
name = 'claimagentdeploy'
main = "workers/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Account and zone configuration (set via environment or dashboard)
# account_id = ""
# zone_id = ""

# Worker routes for production
# routes = [
#   { pattern = "claimagent.io/*", zone_name = "claimagent.io" }
# ]

# Custom domain bindings
# [env.production]
# routes = [
#   { pattern = "app.claimagent.io/*", zone_name = "claimagent.io" }
# ]

# Development environment
[env.development]
name = "claimagent-dev"
vars = { ENVIRONMENT = "development" }

# Staging environment
[env.staging]
name = "claimagent-staging"
vars = { ENVIRONMENT = "staging" }

# Production environment
[env.production]
name = "claimagent-production"
vars = { ENVIRONMENT = "production" }
minify = true

# Static assets configuration for UI
[site]
bucket = ".vercel/output/static"

# Assets configuration
[assets]
directory = ".vercel/output/static"

# D1 Database binding (Cloudflare's SQL database)
[[d1_databases]]
binding = "DB"
database_name = "claimagent-db"
database_id = "" # Set this in Cloudflare Dashboard

# KV Namespace for caching and sessions
[[kv_namespaces]]
binding = "CACHE"
id = "" # Set this in Cloudflare Dashboard

[[kv_namespaces]]
binding = "SESSIONS"
id = "" # Set this in Cloudflare Dashboard

# R2 Storage for documents and uploads
[[r2_buckets]]
binding = "DOCUMENTS"
bucket_name = "claimagent-documents"

[[r2_buckets]]
binding = "UPLOADS"
bucket_name = "claimagent-uploads"

# Durable Objects for real-time claim tracking
# [[durable_objects.bindings]]
# name = "CLAIM_TRACKER"
# class_name = "ClaimTracker"

# Environment variables (secrets should be set via wrangler secret)
[vars]
APP_NAME = "ClaimAgent™"
APP_VERSION = "3.0.0"
API_BASE_URL = "https://api.claimagent.io"

# Build configuration
[build]
command = "npm run build:worker"
cwd = "."
watch_dir = ["src", "workers"]

# Observability
[observability]
enabled = true

# Tail configuration for logging
[tail_consumers]
# service = "claimagent-logging"

# Limits
[limits]
cpu_ms = 50
